<mxfile host="Electron" agent="Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/27.0.9 Chrome/134.0.6998.205 Electron/35.4.0 Safari/537.36" version="27.0.9" pages="6">
  <diagram name="BaseRunner Interface" id="c2puykhdlKecpa7ajLGZ">
    <mxGraphModel dx="4031" dy="1405" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="dYpEXcEKsUXKZA4aVanO-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-17" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-43" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-13" target="dYpEXcEKsUXKZA4aVanO-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-13" value="&lt;h2&gt;interface Runner&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="80" y="30" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-14" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;__init__(config)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-413" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-17" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;run()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-283" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-18" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;warmup()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-153" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-19" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;collect(step)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-3" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-20" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;compute(step)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="137" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-21" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;train(&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;)&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="287" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-22" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;save(episode&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;)&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="427" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-23" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;restore(model_dir&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;)&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="557" y="165" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-24" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;log_train(train_infos, total_num_steps&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;)&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="700" y="165" width="157" height="35" as="geometry" />
        </mxCell>
        <mxCell id="dYpEXcEKsUXKZA4aVanO-25" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;log_env(env_infos, total_num_steps&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;)&lt;/span&gt;&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="900" y="165" width="150" height="35" as="geometry" />
        </mxCell>
        <mxCell id="wxyVG06oh4KQE-dLXqDx-31" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;all_args&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: rgb(0, 168, 132);&quot;&gt;&#39;all_args&#39;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;envs&#39;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;eval_envs&#39;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;device&#39;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;num_agents&#39;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;__contains__&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;render_envs&quot;&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;render_envs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;render_envs&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt;       &lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# parameters&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;env_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;env_name&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;algorithm_name&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;experiment_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;experiment_name&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_centralized_V&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_obs_instead_of_state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_obs_instead_of_state&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_env_steps&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;num_env_steps&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;episode_length&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_rollout_threads&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_eval_rollout_threads&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_render_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_render_rollout_threads&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_linear_lr_decay&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_linear_lr_decay&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;hidden_size&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_wandb&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_wandb&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_render&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_render&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;recurrent_N&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# interval&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;save_interval&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_eval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_eval&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_interval&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;log_interval&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# dir&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;model_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;model_dir&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_wandb&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;str&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;wandb&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;str&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;wandb&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; config&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;run_dir&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;str&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run_dir&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;logs&#39;&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;os&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;path&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;exists&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_dir&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;os&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;makedirs&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;writter&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;SummaryWriter&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;str&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;run_dir&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;models&#39;&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;os&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;path&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;exists&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_dir&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;os&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;makedirs&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.envs.observation_space = num_agents*[Box(observation_space,)]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_observation_space&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_observation_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;observation_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# share_observation_space = Box(observation_space,)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;obs_space: &quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;observation_space&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;share_obs_space: &quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_observation_space&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;act_space: &quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# policy network&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Policy&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;observation_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;],&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_observation_space&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;],&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;model_dir&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;restore&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;model_dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# algorithm&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;TrainAlgo&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# buffer&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;SharedReplayBuffer&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;observation_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;],&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_observation_space&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;],&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: rgb(0, 168, 132);&quot;&gt;&quot;env_name&quot;&lt;/span&gt;])&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-1490" y="165" width="990" height="1390" as="geometry" />
        </mxCell>
        <mxCell id="rHkaLmurHAa_8sMH3zLy-1" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;Calculate returns for the collected data.&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.buffer.share_obs[-1].shape = (self.n_rollout_threads, self.num_agents, len of obs space (etc 217 for football))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.buffer.obs[-1].shape = (self.n_rollout_threads, self.num_agents, len of obs space (etc 217 for football))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.buffer.rnn_states_critic[-1].shape = (self.n_rollout_threads, self.num_agents, 1, 64)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.buffer.masks[-1].shape = (self.n_rollout_threads, self.num_agents, 1), min or max is equal to 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.buffer.available_actions[-1].shape = (self.n_rollout_threads, self.num_agents, action_space(etc 19 for football))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# after np.concatenate their will be (self.n_rollout_threads*self.num_agents, ...)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;next_values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_values&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;next_values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_values&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;available_actions&lt;/span&gt;[&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# next_values.shape = [self.n_rollout_threads*self.num_agents, 1]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;next_values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;next_values&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# next_values.shape = [self.n_rollout_threads, self.num_agents, 1]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;compute_returns&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;next_values&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;value_normalizer&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-440" y="900" width="950" height="480" as="geometry" />
        </mxCell>
        <mxCell id="vI0C1pWsfg6QeTzWpYx5-2" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;Train policies with data in buffer. &quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# switch model parammeters trainble&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_training&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;train&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt;      &lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# Copy last timestep data to first index. &lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic; background-color: rgb(17, 20, 24); font-size: 14px;&quot;&gt;to fill next train batch size.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;after_update&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;train_infos&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="220" y="720" width="590" height="150" as="geometry" />
        </mxCell>
        <mxCell id="vI0C1pWsfg6QeTzWpYx5-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.666;entryY=0.006;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-20" target="rHkaLmurHAa_8sMH3zLy-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vI0C1pWsfg6QeTzWpYx5-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=0.999;entryY=0.011;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-14" target="wxyVG06oh4KQE-dLXqDx-31" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vI0C1pWsfg6QeTzWpYx5-8" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.207;entryY=0.011;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-21" target="vI0C1pWsfg6QeTzWpYx5-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="100" y="560" as="sourcePoint" />
            <mxPoint x="340" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-1" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;Save policy&#39;s actor and critic networks.&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;save&lt;/span&gt;(&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;save_dir&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; episode&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="414" y="630" width="370" height="50" as="geometry" />
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.182;entryY=0.04;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-22" target="_UnLxJ032uDXcNY6aSGp-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-3" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;Restore policy&#39;s networks from a saved model.&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;restore&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;model_dir&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="530" y="550" width="410" height="50" as="geometry" />
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.202;entryY=0.013;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-23" target="_UnLxJ032uDXcNY6aSGp-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-6" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Log env info.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param env_infos: (dict) information about env state.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param total_num_steps: (int) total number of training env steps.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;v&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; env_infos&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;items&lt;/span&gt;():&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;len&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;v&lt;/span&gt;)&lt;span style=&quot;color: #c7910c;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_wandb&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;wandb&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log&lt;/span&gt;({&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;:&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;v&lt;/span&gt;)},&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;writter&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;add_scalars&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;{&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;:&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;v&lt;/span&gt;)},&lt;span style=&quot;color: #11b7d4;&quot;&gt; total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="680" y="270" width="580" height="240" as="geometry" />
        </mxCell>
        <mxCell id="_UnLxJ032uDXcNY6aSGp-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="dYpEXcEKsUXKZA4aVanO-25" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="975" y="270" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="0GVrUQqHnA5cY81wOoYS" name="Footbal runner">
    <mxGraphModel dx="5580" dy="3979" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="1joh9URHdEzHInTS2EPh-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-3" target="p35_9EHNMx_yMuw0TGfm-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-3" target="p35_9EHNMx_yMuw0TGfm-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-3" target="LAMQ1xqaAMBbriFxviNz-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-3" target="QllWKGRzRvH51Kdopwpo-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-3" target="QllWKGRzRvH51Kdopwpo-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="p35_9EHNMx_yMuw0TGfm-3" value="&lt;h2&gt;FootballRunner inherit from baseRunner&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-90" y="-20" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1518" y="25" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="p35_9EHNMx_yMuw0TGfm-7" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;run()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="10" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p35_9EHNMx_yMuw0TGfm-9" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;warmup()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="300" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="p35_9EHNMx_yMuw0TGfm-19" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# reset env&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;ava&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;reset&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# replay buffer&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;use_centralized_V&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;obs&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;share_obs&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;obs&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;available_actions&lt;/span&gt;[&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;ava&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="360" y="170" width="357" height="170" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-33" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="1520" y="-584" width="1170" height="1990" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-16" value="" style="rounded=0;whiteSpace=wrap;html=1;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry width="1020" height="1800" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-17" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="60" y="223" width="908" height="1557" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-18" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;use_linear_lr_decay&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;lr_decay&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episode&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episodes&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="68" y="233" width="408" height="50" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-21" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; line-height: 19px; white-space: pre;&quot;&gt;&lt;h4 style=&quot;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); font-weight: normal; line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# predicted from model&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;collect&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;step&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# values.shape = (self.n_rollout_threads, self.num_agents, 1) &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# actions.shape = (self.n_rollout_threads, self.num_agents, 1) &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# action_log_probs.shape = (self.n_rollout_threads, self.num_agents, 1)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# rnn_states.shape = (self.n_rollout_threads, self.num_agents, 1, 64)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# rnn_states_critic.shape = (self.n_rollout_threads, self.num_agents, 1, 64)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;step&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs.shape = (self.n_rollout_threads, self.num_agents, 217)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# share_obs.shape = (self.n_rollout_threads, self.num_agents, 217)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# rewards.shape = (self.n_rollout_threads, self.num_agents, 1)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# dones.shape = (self.n_rollout_threads, self.num_agents)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# infos.shape = len of self.n_rollout_threads and score_reward value of self.num_agents&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# available_actions.shape = (self.n_rollout_threads, self.num_agents, 19)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;all&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# dones_env.shape = (self.n_rollout_threads, ) boolian&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;reward_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;flatten&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# reward_env.shape = (self.n_rollout_threads, )&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;reward_env&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# train_episode_rewards.shape = (self.n_rollout_threads, )&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;score_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t_info&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;][&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;score_reward&quot;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;t_info&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# score_env len of self.n_rollout_threads&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;score_env&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;):&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones_env&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;]:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_rewards&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_rewards&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_rewards&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_scores&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_scores&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_scores&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# insert data into buffer&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;insert&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;data&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/h4&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="120.5" y="293" width="807.5" height="697" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-22" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); line-height: 19px;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;episode_length&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="618" y="253" width="330" height="40" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-24" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); background-color: rgb(17, 20, 24); font-size: 14px; line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# compute return and update network&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;compute&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;train&lt;/span&gt;()&lt;/div&gt;&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# post process&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# save model&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;or&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episodes&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;save&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# log information&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;end&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Scenario &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Algo &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Exp &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; updates &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; episodes, total num timesteps &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;, FPS &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;            &lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;format&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;scenario&quot;&lt;/span&gt;],&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;experiment_name&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episodes&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_env_steps&lt;/span&gt;,&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;int&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;end&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;start&lt;/span&gt;))))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_train&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;len&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_rewards&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_rewards&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;writter&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;add_scalars&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;train_episode_rewards&quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;{&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;aver_rewards&quot;&lt;/span&gt;:&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_rewards&lt;/span&gt;},&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_scores&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;writter&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;add_scalars&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;train_episode_scores&quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;{&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;aver_scores&quot;&lt;/span&gt;:&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_scores&lt;/span&gt;},&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;some episodes done, average rewards: &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;, scores: &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                &lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;format&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_rewards&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;aver_episode_scores&lt;/span&gt;))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# eval&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;and&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_eval&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eval&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="73.25" y="1004" width="902" height="767" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-25" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); background-color: rgb(17, 20, 24); font-size: 14px; line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;warmup&lt;/span&gt;()&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;start&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episodes&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;int&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_env_steps&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;)]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;)]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;done_episodes_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="16" y="10" width="778" height="200" as="geometry" />
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-31" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.338;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1joh9URHdEzHInTS2EPh-33" source="1joh9URHdEzHInTS2EPh-16" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="90" y="494" as="sourcePoint" />
            <mxPoint x="57" y="608" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-32" value="" style="endArrow=classic;html=1;rounded=0;entryX=-0.001;entryY=0.454;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0;exitY=0.248;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1joh9URHdEzHInTS2EPh-33" source="1joh9URHdEzHInTS2EPh-17" target="1joh9URHdEzHInTS2EPh-21" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="59" y="604" as="sourcePoint" />
            <mxPoint x="120" y="614" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HeHKOO7OLYWbAoLxjB_s-1" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1joh9URHdEzHInTS2EPh-33" source="1joh9URHdEzHInTS2EPh-22" target="1joh9URHdEzHInTS2EPh-21">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="850" y="394" as="sourcePoint" />
            <mxPoint x="900" y="344" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="HeHKOO7OLYWbAoLxjB_s-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1joh9URHdEzHInTS2EPh-33" source="1joh9URHdEzHInTS2EPh-20" target="1joh9URHdEzHInTS2EPh-17">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="850" y="394" as="sourcePoint" />
            <mxPoint x="900" y="344" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="1joh9URHdEzHInTS2EPh-20" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episodes&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1joh9URHdEzHInTS2EPh-33" vertex="1">
          <mxGeometry x="740" y="183" width="270" height="40" as="geometry" />
        </mxCell>
        <mxCell id="LAMQ1xqaAMBbriFxviNz-1" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;collect(step)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="540" width="110" height="30" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div style=&quot;color: rgb(190, 198, 208); background-color: rgb(17, 20, 24); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 14px; line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.share_obs[step].shape = self.n_rollout_threads, self.num_agents, obs_space&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.obs[step].shape = same as above&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.rnn_states[step].shape = self.n_rollout_threads, self.num_agents, 1, 64&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.rnn_states_critic[step].shape = same as above&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.masks[step].shape = self.n_rollout_threads, self.num_agents, 1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.buffer.available_actions[step].shape = self.n_rollout_threads, self.num_agents, act_space&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# after np.concatenate it will be reshaped to self.n_rollout_threads*self.num_agents, ...&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_actions&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;]),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;]),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;]),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;]),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;),&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;available_actions&lt;/span&gt;[&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;]))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# values, actions action_log_probs shape = self.n_rollout_threads, self.num_agents, 1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# rnn_states.shape = self.n_rollout_threads, self.num_agents, 1, 64&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" link="&lt;div style=&quot;color: #bec6d0;background-color: #111418;font-family: &#39;Droid Sans Mono&#39;, &#39;monospace&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;\&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# [self.envs, agents, dim]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" id="QllWKGRzRvH51Kdopwpo-2">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
            <mxGeometry x="360" y="352" width="820" height="465" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="QllWKGRzRvH51Kdopwpo-5" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;insert(data)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="960" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-7" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; share_obs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; rewards&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; dones&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; infos&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; available_actions&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; rnn_states_critic &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; data&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font&gt;# dones.shape = self.n_rollout_threads, self.num_agents&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;all&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font&gt;# dones_env.shape = self.n_rollout_threads&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font&gt;# make zero all the agents that had done their tasks.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;3&lt;/span&gt;:]),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;masks &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;masks&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;active_masks &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;active_masks&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;active_masks&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;(((&lt;span style=&quot;color: #11b7d4;&quot;&gt;dones_env &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    share_obs &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; obs&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;insert&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; rnn_states_critic&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;                    actions&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; action_log_&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="360" y="830" width="1120" height="380" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-9" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;eval(total_num_steps)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="1570" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-11" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;eval_episode&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;])]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;])]&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ava&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reset&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                            &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;while&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;act&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;ava&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;deterministic&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;]))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;]))&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# Obser reward and next obs&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_infos&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ava&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;step&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;flatten&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;t_info&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;][&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;score_reward&quot;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;t_info&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_infos&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_scores&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;all&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;]):&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones_env&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;]:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_rewards&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_rewards&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_scores&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_scores&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_episode_scores&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_i&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# until end of the evaluation eval_episodes&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval_episodes&quot;&lt;/span&gt;]:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;key_average&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;/eval_average_episode_rewards&#39;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;key_max&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;/eval_max_episode_rewards&#39;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;key_scores&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;/eval_average_episode_scores&#39;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_env_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;{&lt;span style=&quot;color: #c62f52;&quot;&gt;key_average&lt;/span&gt;:&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;key_max&lt;/span&gt;:&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;max&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;)],&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;key_scores&lt;/span&gt;:&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_scores&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_env&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_env_infos&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval average episode rewards: &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;, scores: &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;.&quot;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                &lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;format&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_scores&lt;/span&gt;)))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212));&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;break&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="520" y="1230" width="800" height="1130" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.007;entryY=0.856;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="p35_9EHNMx_yMuw0TGfm-9" target="p35_9EHNMx_yMuw0TGfm-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.438;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="LAMQ1xqaAMBbriFxviNz-1" target="QllWKGRzRvH51Kdopwpo-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.001;entryY=0.379;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="QllWKGRzRvH51Kdopwpo-5" target="QllWKGRzRvH51Kdopwpo-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="QllWKGRzRvH51Kdopwpo-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.003;entryY=0.313;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="QllWKGRzRvH51Kdopwpo-9" target="QllWKGRzRvH51Kdopwpo-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="ijjzrDmq9XKugaGoTta_" name="MpeRunner">
    <mxGraphModel dx="4924" dy="-1991" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-6" target="KCAlsgWhhB9wy0VeN7n4-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-6" target="KCAlsgWhhB9wy0VeN7n4-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-6" target="KCAlsgWhhB9wy0VeN7n4-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-6" target="KCAlsgWhhB9wy0VeN7n4-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-6" target="KCAlsgWhhB9wy0VeN7n4-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-6" value="&lt;h2&gt;FootballRunner inherit from baseRunner&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-110" y="5284" width="150" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-8">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1498" y="5329" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-8" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;run()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="5314" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-9" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;warmup()&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="5604" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-10" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# reset env&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reset&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# replay buffer&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;expand_dims&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;repeat&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;obs&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="340" y="5420" width="600" height="204" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-11" value="" style="group" vertex="1" connectable="0" parent="1">
          <mxGeometry x="1500" y="4720" width="1170" height="1990" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-12" value="" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry y="280" width="1060" height="1240" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-13" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="68" y="390" width="908" height="1110" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-14" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;use_linear_lr_decay&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;lr_decay&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episode&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episodes&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="73.25" y="400" width="408" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-15" value="" style="group" vertex="1" connectable="0" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="780" y="350" width="270" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-16" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episodes&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-15">
          <mxGeometry width="270" height="40" as="geometry" />
        </mxCell>
        <mxCell id="gfvw1UXe750cU7-wgTPR-2" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0.719;entryY=1.025;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="KCAlsgWhhB9wy0VeN7n4-15" source="KCAlsgWhhB9wy0VeN7n4-16" target="KCAlsgWhhB9wy0VeN7n4-16">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-186" y="200" as="sourcePoint" />
            <mxPoint x="200" y="40" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-17" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; line-height: 19px; white-space: pre;&quot;&gt;&lt;h4 style=&quot;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); font-weight: normal; line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# Sample actions&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;collect&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;step&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;    &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# Obser reward and next obs&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;step&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;actions_env&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# insert data into buffer&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;insert&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;data&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/h4&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="100" y="460" width="807.5" height="220" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-18" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); line-height: 19px;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;episode_length&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="597.5" y="420" width="330" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-19" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); background-color: rgb(17, 20, 24); font-size: 14px; line-height: 19px;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# compute return and update network&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;compute&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;train&lt;/span&gt;()&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# post process&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# save model&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;save_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;or&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episodes&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;):&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;save&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;)&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# log information&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;end&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Scenario &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Algo &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; Exp &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; updates &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt; episodes, total num timesteps &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;, FPS &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;            &lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;format&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;all_args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;scenario_name&quot;&lt;/span&gt;],&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;experiment_name&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episodes&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_env_steps&lt;/span&gt;,&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;int&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;end&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;start&lt;/span&gt;))))&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;env_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;MPE&quot;&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;env_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;{}&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_id&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;):&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;idv_rews&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;info&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;individual_reward&#39;&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;info&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_id&lt;/span&gt;].&lt;span style=&quot;color: #11b7d4;&quot;&gt;keys&lt;/span&gt;():&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;idv_rews&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;info&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_id&lt;/span&gt;][&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;individual_reward&#39;&lt;/span&gt;])&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_k&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;agent&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;%i&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;/individual_rewards&#39;&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_id&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;env_infos&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;agent_k&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;idv_rews&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;average_episode_rewards&quot;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rewards&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;average episode rewards is &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;{}&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;format&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;average_episode_rewards&quot;&lt;/span&gt;]))&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_train&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;train_infos&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_env&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;env_infos&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: rgb(71, 82, 98);&quot;&gt;# eval&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;episode&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;%&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_interval&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;and&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_eval&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eval&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="74" y="690" width="902" height="811" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-20" value="&lt;div style=&quot;color: rgb(62, 69, 78); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; white-space: pre;&quot;&gt;&lt;div style=&quot;color: rgb(190, 198, 208); line-height: 19px;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;warmup&lt;/span&gt;()&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;   &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.gif_dir&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;./gifs&quot;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;start&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;time&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;episodes&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;int&lt;/span&gt;(&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;num_env_steps&lt;/span&gt;)&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;episode_length&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;//&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="KCAlsgWhhB9wy0VeN7n4-11">
          <mxGeometry x="10" y="290" width="654" height="90" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-22" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.197;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="KCAlsgWhhB9wy0VeN7n4-11" source="KCAlsgWhhB9wy0VeN7n4-13">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="59" y="884" as="sourcePoint" />
            <mxPoint x="98" y="608" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gfvw1UXe750cU7-wgTPR-1" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="KCAlsgWhhB9wy0VeN7n4-11" source="KCAlsgWhhB9wy0VeN7n4-18" target="KCAlsgWhhB9wy0VeN7n4-17">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="580" y="550" as="sourcePoint" />
            <mxPoint x="630" y="500" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="gfvw1UXe750cU7-wgTPR-3" value="" style="endArrow=classic;html=1;rounded=0;exitX=-0.001;exitY=0.265;exitDx=0;exitDy=0;exitPerimeter=0;entryX=-0.003;entryY=0.197;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="KCAlsgWhhB9wy0VeN7n4-11" source="KCAlsgWhhB9wy0VeN7n4-12" target="KCAlsgWhhB9wy0VeN7n4-13">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="150" y="630" as="sourcePoint" />
            <mxPoint x="200" y="580" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-23" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;collect(step)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="5844" width="110" height="30" as="geometry" />
        </mxCell>
        <UserObject label="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-weight: normal; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 14px; line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;prep_rollout&lt;/span&gt;()&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;value,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;action,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;action_log_prob,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;rnn_states,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;rnn_states_critic&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_actions&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;step&lt;/span&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;step&lt;/span&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;step&lt;/span&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;step&lt;/span&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;step&lt;/span&gt;]))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;values&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;value&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;actions&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;action&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;action_log_probs&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;action_log_prob&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;# rearrange action&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #c62f52;&quot;&gt;__class__&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__name__&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;MultiDiscrete&#39;&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;i&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;):&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;uc_actions_env&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eye&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;high&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;i&lt;/span&gt;]&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;actions&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;i&lt;/span&gt;]]&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;actions_env&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;uc_actions_env&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;((&lt;span style=&quot;color: #d4770c;&quot;&gt;actions_env&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;uc_actions_env&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;elif&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #c62f52;&quot;&gt;__class__&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__name__&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;squeeze&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eye&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;n&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;actions&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;raise&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;NotImplementedError&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;rnn_states_critic&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;actions_env&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" link="&lt;div style=&quot;color: #bec6d0;background-color: #111418;font-family: &#39;Droid Sans Mono&#39;, &#39;monospace&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;()&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;\&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;masks&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;step&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;]))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# [self.envs, agents, dim]&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_prob&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_state_critic&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;),&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;))&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;&lt;span style=&quot;color: #bec6d0;&quot;&gt;,&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" id="KCAlsgWhhB9wy0VeN7n4-24">
          <mxCell style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
            <mxGeometry x="340" y="5634" width="750" height="481" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-25" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;insert(data)&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="6264" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-26" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;background-color: rgb(17, 20, 24); font-size: 14px; line-height: 19px;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;infos&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;data&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states_critic&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;3&lt;/span&gt;:]),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;masks&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;dones&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;expand_dims&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;repeat&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;insert&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rewards&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;masks&lt;/span&gt;)&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="340" y="6190" width="1120" height="234" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-27" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;eval(total_num_steps)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="6874" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-28" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;eval_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reset&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;use_centralized_V&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;expand_dims&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;repeat&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;rnn_states&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;2&lt;/span&gt;:]),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_step&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;episode_length&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;prep_rollout&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_action&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;trainer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;act&lt;/span&gt;(&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_share_obs&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;deterministic&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_action&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;split&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;_t2n&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;    &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #c62f52;&quot;&gt;__class__&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__name__&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;MultiDiscrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_uc_actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eye&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;high&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;]&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;]]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_uc_actions_env&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;                &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;concatenate&lt;/span&gt;((&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions_env&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_uc_actions_env&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;2&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;elif&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #c62f52;&quot;&gt;__class__&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__name__&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions_env&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;squeeze&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;eye&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_space&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;].&lt;span style=&quot;color: #d4770c;&quot;&gt;n&lt;/span&gt;)[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;2&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;raise&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;NotImplementedError&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# Obser reward and next obs&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_obs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;eval_envs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;step&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_actions_env&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rewards&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_rnn_states&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;recurrent_N&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;hidden_size&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;((&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_eval_rollout_threads&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_masks&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(((&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_dones&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_env_infos&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;{}&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_env_infos&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;eval_average_episode_rewards&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;array&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_episode_rewards&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;axis&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_average_episode_rewards&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_env_infos&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;eval_average_episode_rewards&#39;&lt;/span&gt;])&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;eval average episode rewards of agent: &quot;&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;str&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;eval_average_episode_rewards&lt;/span&gt;))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;log_env&lt;/span&gt;(&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;eval_env_infos&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;total_num_steps&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="370" y="6460" width="1060" height="976" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-29" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-9">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="339" y="5619" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.003;entryY=0.469;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-23" target="KCAlsgWhhB9wy0VeN7n4-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.001;entryY=0.379;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-25" target="KCAlsgWhhB9wy0VeN7n4-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KCAlsgWhhB9wy0VeN7n4-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.002;entryY=0.44;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KCAlsgWhhB9wy0VeN7n4-27" target="KCAlsgWhhB9wy0VeN7n4-28">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="360" y="6890" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="C6hnAAHg7fnzbGlptzra" name="MATTrainer">
    <mxGraphModel dx="3702" dy="1686" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="RorI2Iw0lrJwscMBh6EG-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XfTpQgudUNR8ynLYuLV4-1" target="RorI2Iw0lrJwscMBh6EG-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XfTpQgudUNR8ynLYuLV4-1" target="MSeAozfp_X0kNaaQCLL--1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XfTpQgudUNR8ynLYuLV4-1" target="MSeAozfp_X0kNaaQCLL--5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="XfTpQgudUNR8ynLYuLV4-1" target="7NpFFlv3scnC75gSiTEv-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XfTpQgudUNR8ynLYuLV4-1" value="&lt;h2&gt;MATTrainer&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="390" y="60" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="RorI2Iw0lrJwscMBh6EG-1" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;__init__(args, policy, num_agents, device=torch.device(&quot;cpu&quot;))&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="-270" y="160" width="440" height="40" as="geometry" />
        </mxCell>
        <mxCell id="RorI2Iw0lrJwscMBh6EG-3" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; device&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;dict&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; policy&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; num_agents&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;clip_param&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;clip_param&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;ppo_epoch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;ppo_epoch&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_mini_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;num_mini_batch&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;data_chunk_length&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;data_chunk_length&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_loss_coef&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;value_loss_coef&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;entropy_coef&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;entropy_coef&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;max_grad_norm&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;max_grad_norm&quot;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt;       &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;huber_delta&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;huber_delta&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_recurrent_policy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_recurrent_policy&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_naive_recurrent&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_naive_recurrent_policy&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_max_grad_norm&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_max_grad_norm&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_clipped_value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_clipped_value_loss&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_huber_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_huber_loss&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_valuenorm&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_valuenorm&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_value_active_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_value_active_masks&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_policy_active_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_policy_active_masks&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dec_actor&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;dec_actor&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_valuenorm&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_normalizer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;ValueNorm&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;value_normalizer&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(227, 85, 53);&quot;&gt;None&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="-490" y="240" width="500" height="500" as="geometry" />
        </mxCell>
        <mxCell id="RorI2Iw0lrJwscMBh6EG-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.88;entryY=-0.006;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="RorI2Iw0lrJwscMBh6EG-1" target="RorI2Iw0lrJwscMBh6EG-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--1" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;cal_value_loss(values, value_preds_batch, return_batch, active_masks_batch)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="200" y="160" width="400" height="40" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--3" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Calculate value function loss.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param values: (torch.Tensor) value function predictions.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param value_preds_batch: (torch.Tensor) &quot;old&quot; value  predictions from data batch (used for value clip loss)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param return_batch: (torch.Tensor) reward to go returns.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param active_masks_batch: (torch.Tensor) denotes if agent is active or dead at a given timesep.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return value_loss: (torch.Tensor) value function loss.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_pred_clipped&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; value_preds_batch &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #a0acbb;&quot;&gt;values &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; value_preds_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;clamp&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;clip_param&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                            &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;clip_param&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_valuenorm&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_normalizer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;update&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;return_batch&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;error_clipped&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_normalizer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;normalize&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;return_batch&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_pred_clipped&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;error_original&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_normalizer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;normalize&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;return_batch&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; values&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;error_clipped&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; return_batch &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_pred_clipped&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;error_original&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; return_batch &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; values&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_huber_loss&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_clipped&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;huber_loss&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;error_clipped&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;huber_delta&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_original&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;huber_loss&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;error_original&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;huber_delta&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_clipped&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;mse_loss&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;error_clipped&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_original&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;mse_loss&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;error_original&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_clipped_value_loss&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;max&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_original&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_clipped&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss_original&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# if self._use_value_active_masks and not self.dec_actor:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_value_active_masks&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; active_masks_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; active_masks_batch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;value_loss&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="20" y="240" width="850" height="750" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.447;entryY=0.004;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="MSeAozfp_X0kNaaQCLL--1" target="MSeAozfp_X0kNaaQCLL--3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="MSeAozfp_X0kNaaQCLL--5" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;ppo_update(sample)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="860" y="160" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-1" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Update actor and critic networks.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param sample: (Tuple) contains data batch with which to update networks.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:update_actor: (bool) whether to update actor network.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return value_loss: (torch.Tensor) value function loss.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return critic_grad_norm: (torch.Tensor) gradient norm from critic up9date.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;;return policy_loss: (torch.Tensor) actor(policy) loss value.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return dist_entropy: (torch.Tensor) action entropies.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return actor_grad_norm: (torch.Tensor) gradient norm from actor update.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return imp_weights: (torch.Tensor) importance sampling weights.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_preds_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;return_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;masks_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;old_action_log_probs_batch&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;adv_targ&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; sample&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# available_actions_batch.shape = episoide_len*self.n_rollout_threads*num_agents, act_space&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# adv_targ.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# old_action_log_probs_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# active_masks_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# masks_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# return_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# value_preds_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# actions_batch.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs_batch.shape = episoide_len*self.n_rollout_threads*num_agents, obs_space&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;old_action_log_probs_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;old_action_log_probs_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;adv_targ&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;adv_targ&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_preds_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;value_preds_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;return_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;return_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# values.shape = episoide_len*self.n_rollout_threads*num_agents, 1&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# Reshape to do in a single forward pass for all steps&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dist_entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;evaluate_actions&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;share_obs_batch&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;masks_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions_batch&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# actor update&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;imp_weights&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;exp&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;old_action_log_probs_batch&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;surr1&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;imp_weights&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;adv_targ&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;surr2&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;clamp&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;imp_weights&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1.0&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;clip_param&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1.0&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;clip_param&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;adv_targ&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_policy_active_masks&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;policy_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;min&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;surr1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;surr2&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;keepdim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;policy_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;min&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;surr1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;surr2&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;keepdim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# critic update&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;cal_value_loss&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_preds_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;return_batch&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;active_masks_batch&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;policy_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dist_entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;entropy_coef&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;value_loss_coef&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;optimizer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zero_grad&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;loss&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;backward&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_max_grad_norm&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;grad_norm&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;utils&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;clip_grad_norm_&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;parameters&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;max_grad_norm&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;grad_norm&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_gard_norm&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;parameters&lt;/span&gt;())&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;policy&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;optimizer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;step&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;value_loss&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;grad_norm&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;policy_loss&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;dist_entropy&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;grad_norm&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;imp_weights&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="900" y="240" width="790" height="1250" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.058;entryY=0.003;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="MSeAozfp_X0kNaaQCLL--5" target="7NpFFlv3scnC75gSiTEv-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-3" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;train(buffer)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1710" y="160" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-4" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Perform a training update using minibatch GD.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param buffer: (SharedReplayBuffer) buffer containing training data.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param update_actor: (bool) whether to update actor network.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return train_info: (dict) contains information regarding training update (e.g. loss, grad norms, etc).&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages_copy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;advantages&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;copy&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages_copy&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;active_masks&lt;/span&gt;[:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0.0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;nan&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;mean_advantages&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;nanmean&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages_copy&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;std_advantages&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;nanstd&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages_copy&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #a0acbb;&quot;&gt;buffer&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;advantages&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;mean_advantages&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;std_advantages&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1e-5&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;{}&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;value_loss&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;policy_loss&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;dist_entropy&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;actor_grad_norm&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;critic_grad_norm&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;ratio&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;ppo_epoch&lt;/span&gt;):&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;data_generator&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; buffer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;feed_forward_generator_transformer&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;advantages&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_mini_batch&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;sample&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;data_generator&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;critic_grad_norm&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;policy_loss&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dist_entropy&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actor_grad_norm&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;imp_weights&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;\&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ppo_update&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;sample&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;value_loss&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;value_loss&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;item&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;policy_loss&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;policy_loss&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;item&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;dist_entropy&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;dist_entropy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;item&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;actor_grad_norm&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actor_grad_norm&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;critic_grad_norm&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;critic_grad_norm&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;ratio&#39;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;imp_weights&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;num_updates&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;ppo_epoch&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_mini_batch&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;keys&lt;/span&gt;():&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;k&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;/=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;num_updates&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;train_info&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="1710" y="240" width="810" height="870" as="geometry" />
        </mxCell>
        <mxCell id="7NpFFlv3scnC75gSiTEv-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.067;entryY=0.004;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="7NpFFlv3scnC75gSiTEv-3" target="7NpFFlv3scnC75gSiTEv-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="aXjHc2a9Ok-Q1Efq6PnH" name="TransformerPolicy">
    <mxGraphModel dx="4415" dy="2108" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="KPQZ45TC6yJRGMdMW7jc-1" target="KPQZ45TC6yJRGMdMW7jc-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="KPQZ45TC6yJRGMdMW7jc-1" target="3bQv7dFHeyJQGhaLQCCB-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="KPQZ45TC6yJRGMdMW7jc-1" target="3bQv7dFHeyJQGhaLQCCB-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="KPQZ45TC6yJRGMdMW7jc-1" target="3bQv7dFHeyJQGhaLQCCB-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KPQZ45TC6yJRGMdMW7jc-1" value="&lt;h2&gt;TransformerPolicy&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="340" y="10" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KPQZ45TC6yJRGMdMW7jc-2" value="&lt;b&gt;&lt;font style=&quot;font-size: 14px;&quot;&gt;__init__(self, args, obs_space, cent_obs_space, act_space, num_agents, device=torch.device(&quot;cpu&quot;))&lt;/font&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-360" y="120" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-2" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs_space shape is diffrent relative to enviroment etc foorball has 217&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# act_space shape is diffrent relative to enviroment etc foorball has 19&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; device&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;algorithm_name&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;lr&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;lr&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;opti_eps&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;opti_eps&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;weight_decay&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;weight_decay&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_policy_active_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;use_policy_active_masks&quot;&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; act_space&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__class__&lt;/span&gt;.&lt;span style=&quot;color: #c62f52;&quot;&gt;__name__&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Box&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Continuous&#39;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_shape_from_obs_space&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_space&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_shape_from_obs_space&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;cent_obs_space&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; act_space&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;act high: &quot;&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; act_space&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;high&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; act_space&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;shape&lt;/span&gt;[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;    &lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; num_agents&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;dict&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mat&quot;&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mat_dec&quot;&lt;/span&gt;]:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;model&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;algorithm&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ma_transformer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MultiAgentTransformer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MAT&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;elif&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mat_gru&quot;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;model&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;algorithm&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mat_gru&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MultiAgentGRU&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MAT&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;elif&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mat_decoder&quot;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;model&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;algorithm&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mat_decoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MultiAgentDecoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MAT&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;elif&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;algorithm_name&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mat_encoder&quot;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;from&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;model&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;algorithm&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mat_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;import&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MultiAgentEncoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;as&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MAT&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;raise&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;NotImplementedError&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;MAT&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; num_agents&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;n_block&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_block&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;n_embd&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_embd&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;n_head&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;n_head&quot;&lt;/span&gt;],&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;encode_state&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;encode_state&quot;&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;device&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dec_actor&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;dec_actor&quot;&lt;/span&gt;],&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;share_actor&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;share_actor&quot;&lt;/span&gt;])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; args&lt;/span&gt;[&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;env_name&quot;&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;hands&quot;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zero_std&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;optimizer&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;optim&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Adam&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;parameters&lt;/span&gt;(),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;lr&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;lr&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;eps&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;opti_eps&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;weight_decay&lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;weight_decay&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="-740" y="225" width="740" height="960" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.79;entryY=0.001;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="KPQZ45TC6yJRGMdMW7jc-2" target="3bQv7dFHeyJQGhaLQCCB-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="3bQv7dFHeyJQGhaLQCCB-4" target="3bQv7dFHeyJQGhaLQCCB-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-4" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;get_actions(self, cent_obs, obs, rnn_states_actor, rnn_states_critic, masks, available_actions=None, deterministic=False)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="195" y="117.5" width="460" height="45" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-6" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Compute actions and value function predictions for the given inputs.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param cent_obs (np.ndarray): centralized input to the critic.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param obs (np.ndarray): local agent inputs to the actor.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param rnn_states_actor: (np.ndarray) if actor is RNN, RNN states for actor.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param rnn_states_critic: (np.ndarray) if critic is RNN, RNN states for critic.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param masks: (np.ndarray) denotes points at which RNN states should be reset.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param available_actions: (np.ndarray) denotes which actions are available to agent&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;                            (if None, all actions available)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param deterministic: (bool) whether the action should be mode of distribution or should be sampled.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return values: (torch.Tensor) value function predictions.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return actions: (torch.Tensor) actions to take.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return action_log_probs: (torch.Tensor) log probabilities of chosen actions.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return rnn_states_actor: (torch.Tensor) updated actor network RNN states.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return rnn_states_critic: (torch.Tensor) updated critic network RNN states.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; cent_obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_actions&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                    deterministic&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# unused, just for compatibility&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_actor&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;rnn_states_actor&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;rnn_states_critic&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;rnn_states_actor&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;rnn_states_critic&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="30" y="225" width="790" height="650" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-8" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;get_values(self, cent_obs, obs, rnn_states_critic, masks, available_actions=None)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="910" y="118.75" width="400" height="42.5" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-10" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;font-size: 14px; line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;Get value function predictions.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;:param cent_obs (np.ndarray): centralized input to the critic.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;:param rnn_states_critic: (np.ndarray) if critic is RNN, RNN states for critic.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;:param masks: (np.ndarray) denotes points at which RNN states should be reset.&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;:return values: (torch.Tensor) value function predictions.&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&quot;&quot;&quot;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; cent_obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs_dim&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;transformer&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;get_values&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;values&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="850" y="225" width="720" height="295" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.36;entryY=0.006;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="3bQv7dFHeyJQGhaLQCCB-8" target="3bQv7dFHeyJQGhaLQCCB-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="3bQv7dFHeyJQGhaLQCCB-12" target="3bQv7dFHeyJQGhaLQCCB-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-12" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;evaluate_actions(self, cent_obs, obs, rnn_states_actor, rnn_states_critic, actions, masks, available_actions=None, active_masks=None)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1700" y="118.75" width="520" height="42.5" as="geometry" />
        </mxCell>
        <mxCell id="3bQv7dFHeyJQGhaLQCCB-14" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;Get action logprobs / entropy and value function predictions for actor update.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param cent_obs (np.ndarray): centralized input to the critic.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param obs (np.ndarray): local agent inputs to the actor.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param rnn_states_actor: (np.ndarray) if actor is RNN, RNN states for actor.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param rnn_states_critic: (np.ndarray) if critic is RNN, RNN states for critic.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param actions: (np.ndarray) actions whose log probabilites and entropy to compute.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param masks: (np.ndarray) denotes points at which RNN states should be reset.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param available_actions: (np.ndarray) denotes which actions are available to agent&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;                            (if None, all actions available)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:param active_masks: (torch.Tensor) denotes whether an agent is active or dead.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return values: (torch.Tensor) value function predictions.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return action_log_probs: (torch.Tensor) log probabilities of the input actions.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;:return dist_entropy: (torch.Tensor) action distribution entropy for the given inputs.&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(65, 131, 175); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&quot;&quot;&quot;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; cent_obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_obs_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; obs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; actions&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;reshape&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;num_agents&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_dim&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;transformer&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;cent_obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actions&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log_probs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;values&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;view&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;act_num&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;_use_policy_active_masks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;and&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; active_masks &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;active_masks&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;span style=&quot;color: #c7910c;&quot;&gt;/&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;active_masks&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sum&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mean&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;values&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;action_log_probs&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;entropy&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1585" y="220" width="750" height="660" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="iyNDnWkcckCRqlSaXAgz" name="MATransformerModel">
    <mxGraphModel dx="6554" dy="3372" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bro4JHDs7asBWm0_dCjU-1" target="Bpqc18DR_6Pw1rMxWVhk-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bro4JHDs7asBWm0_dCjU-1" target="Bpqc18DR_6Pw1rMxWVhk-6">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bro4JHDs7asBWm0_dCjU-1" value="&lt;h2&gt;Encoder&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry y="110" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-1" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;__init__(state_dim, obs_dim, n_block, n_embd, n_head, n_agent, encode_state)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-380" y="210" width="410" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-3" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;state_dim&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; state_dim&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; obs_dim&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_embd&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; n_embd&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_agent&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; n_agent&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;encode_state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; encode_state&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# self.agent_id_emb = nn.Parameter(torch.zeros(1, n_agent, n_embd))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;state_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;state_dim&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;state_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;())&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;())&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;ln&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;blocks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(*[&lt;span style=&quot;color: #a85ff1;&quot;&gt;EncodeBlock&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_head&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;)&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_block&lt;/span&gt;)])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;head&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;                            &lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;1&lt;/span&gt;)))&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="-750" y="330" width="840" height="330" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.684;entryY=-0.007;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-1" target="Bpqc18DR_6Pw1rMxWVhk-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-6" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;forward(state, obs)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="210" width="180" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-8" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state: (batch, n_agent, state_dim)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs: (batch, n_agent, obs_dim)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;encode_state&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state_embeddings&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;state_encoder&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;state&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state_embeddings&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_embeddings&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_encoder&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_embeddings&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;rep&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;blocks&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ln&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;))&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;v_loc&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;head&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;rep&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;v_loc&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;rep&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="120" y="330" width="380" height="270" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.421;entryY=0.011;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-6" target="Bpqc18DR_6Pw1rMxWVhk-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-12" target="Bpqc18DR_6Pw1rMxWVhk-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-12" target="Bpqc18DR_6Pw1rMxWVhk-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-12" target="Bpqc18DR_6Pw1rMxWVhk-19">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-12" value="&lt;h2&gt;Decoder&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1350" y="110" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-13" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;__init__(obs_dim, action_dim, n_block, n_embd, n_head, n_agent, action_type=&#39;Discrete&#39;, dec_actor=False, share_actor=False)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="900" y="210" width="450" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-14" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;action_dim&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; action_dim&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_embd&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; n_embd&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dec_actor&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; dec_actor&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_actor&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; share_actor&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_type&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_type &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;log_std&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ones&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action_dim&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# log_std = torch.zeros(action_dim)&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_std&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Parameter&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;log_std&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.log_std = torch.nn.Parameter(torch.zeros(action_dim))&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dec_actor&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_actor&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;print&lt;/span&gt;(&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;mac_dec!!!!!&quot;&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;mlp&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim&lt;/span&gt;)))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;mlp&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;ModuleList&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;n&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_agent&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;actor&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                    &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim&lt;/span&gt;)))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;mlp&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;actor&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# self.agent_id_emb = nn.Parameter(torch.zeros(1, n_agent, n_embd))&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_type &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action_dim &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;bias&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;False&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                            &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;())&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;())&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;obs_encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                        &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;())&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;ln&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;blocks&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(*[&lt;span style=&quot;color: #a85ff1;&quot;&gt;DecodeBlock&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_head&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;)&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;_&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_block&lt;/span&gt;)])&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;head&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Sequential&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;activate&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;True&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;GELU&lt;/span&gt;(),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: #a85ff1;&quot;&gt;LayerNorm&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_embd&lt;/span&gt;),&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;                                &lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;init_&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;nn&lt;/span&gt;.&lt;span style=&quot;color: rgb(168, 95, 241);&quot;&gt;Linear&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;n_embd&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; action_dim&lt;/span&gt;)))&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="520" y="330" width="930" height="800" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.65;entryY=0.004;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-13" target="Bpqc18DR_6Pw1rMxWVhk-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-16" value="&lt;b style=&quot;font-size: 14px;&quot;&gt;forward(&lt;/b&gt;&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;action, obs_rep, obs&lt;/b&gt;&lt;/span&gt;&lt;b style=&quot;font-size: 14px;&quot;&gt;)&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1540" y="210" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-17" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# action: (batch, n_agent, action_dim), one-hot/logits?&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs_rep: (batch, n_agent, n_embd)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;dec_actor&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;share_actor&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;mlp&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;[]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;n&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;len&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;mlp&lt;/span&gt;)):&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit_n&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;mlp&lt;/span&gt;[&lt;span style=&quot;color: #c62f52;&quot;&gt;n&lt;/span&gt;](&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;[:,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;n&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;:])&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;            &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;append&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;logit_n&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;stack&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_embeddings&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;action_encoder&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;ln&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action_embeddings&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;block&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;blocks&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;block&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_rep&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;head&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;x&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;logit&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1470" y="330" width="440" height="380" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.399;entryY=0.008;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-16" target="Bpqc18DR_6Pw1rMxWVhk-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-19" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;zero_std(device)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="2010" y="210" width="130" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-20" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 168, 132);&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;log_std&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;log_std&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;data&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;log_std&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1930" y="330" width="420" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.344;entryY=0.058;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-19" target="Bpqc18DR_6Pw1rMxWVhk-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-23" target="Bpqc18DR_6Pw1rMxWVhk-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-23" value="&lt;h2&gt;discrete_autoregreesive_act(decoder, obs_rep, obs, batch_size, n_agent, action_dim, tpdv, available_actions=None, deterministic=False)&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-725" y="1170" width="630" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-24" value="&lt;div style=&quot;color: rgb(190, 198, 208); background-color: rgb(17, 20, 24); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #11b7d4;&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #11b7d4;&quot;&gt;tpdv&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #11b7d4;&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;long&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros_like&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_agent&lt;/span&gt;):&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs&lt;/span&gt;)[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;available_actions&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1e10&lt;/span&gt;&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Categorical&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;logits&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;probs&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;argmax&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;dim&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; deterministic &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sample&lt;/span&gt;()&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_prob&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;)&lt;/div&gt;&lt;br&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;unsqueeze&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;unsqueeze&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; n_agent&lt;/span&gt;:&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;F&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;one_hot&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;num_classes&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;action_dim&lt;/span&gt;)&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="-750" y="1280" width="680" height="370" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-29" target="Bpqc18DR_6Pw1rMxWVhk-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-29" value="&lt;h2&gt;discrete_parallel_act(decoder, obs_rep, obs, action, batch_size, n_agent, action_dim, tpdv, available_actions=None)&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="180" y="1170" width="630" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-30" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; font-size: 14px; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;one_hot_action&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;F&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;one_hot&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;action&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;squeeze&lt;/span&gt;(&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;1&lt;/span&gt;),&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 110, 192);&quot;&gt;num_classes&lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;action_dim&lt;/span&gt;)&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;  &lt;/span&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;# (batch, n_agent, action_dim)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #11b7d4;&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #11b7d4;&quot;&gt;tpdv&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;one_hot_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;[&lt;span style=&quot;color: #a0acbb;&quot;&gt;available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1e10&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;br&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Categorical&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;logits&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;logit&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_prob&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;squeeze&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)).&lt;span style=&quot;color: #11b7d4;&quot;&gt;unsqueeze&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;entropy&lt;/span&gt;().&lt;span style=&quot;color: #11b7d4;&quot;&gt;unsqueeze&lt;/span&gt;(&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;action_log&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;entropy&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="60" y="1280" width="870" height="250" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-32" target="Bpqc18DR_6Pw1rMxWVhk-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-32" value="&lt;h2&gt;continuous_autoregreesive_act(decoder, obs_rep, obs, batch_size, n_agent, action_dim, tpdv, deterministic=False)&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1045" y="1170" width="630" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-33" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;shifted_action&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; action_dim&lt;/span&gt;)).&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #11b7d4;&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros_like&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;for&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;in&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;range&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;n_agent&lt;/span&gt;):&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;act_mean&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs&lt;/span&gt;)[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_std&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sigmoid&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_std&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0.5&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# log_std = torch.zeros_like(act_mean).to(**tpdv) + decoder.log_std&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #475262;font-style: italic;&quot;&gt;# distri = Normal(act_mean, log_std.exp())&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Normal&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;act_mean&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_std&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;act_mean&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; deterministic &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sample&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_prob&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; n_agent&lt;/span&gt;:&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;        &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;i&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;+&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;output_action_log&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1030" y="1280" width="660" height="390" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-35" target="Bpqc18DR_6Pw1rMxWVhk-36">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-35" value="&lt;h2&gt;continuous_parallel_act(decoder, obs_rep, obs, action, batch_size, n_agent, action_dim, tpdv)&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1910" y="1170" width="630" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-36" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;div style=&quot;line-height: 19px;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;shifted_action&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;batch_size&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt; action_dim&lt;/span&gt;)).&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action&lt;/span&gt;[:,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;:]&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;act_mean&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;shifted_action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_std&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;sigmoid&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;decoder&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;log_std&lt;/span&gt;)&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;0.5&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Normal&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;act_mean&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_std&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# log_std = torch.zeros_like(act_mean).to(**tpdv) + decoder.log_std&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# distri = Normal(act_mean, log_std.exp())&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;log_prob&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action&lt;/span&gt;)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;distri&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;entropy&lt;/span&gt;()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;action_log&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;entropy&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1925" y="1280" width="600" height="270" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-39" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-37" target="Bpqc18DR_6Pw1rMxWVhk-38">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-37" target="Bpqc18DR_6Pw1rMxWVhk-47">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-37" target="Bpqc18DR_6Pw1rMxWVhk-52">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-37" target="Bpqc18DR_6Pw1rMxWVhk-42">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-58" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-37" target="Bpqc18DR_6Pw1rMxWVhk-57">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-37" value="&lt;h2&gt;MultiAgentTransformer&lt;/h2&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="875" y="1770" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-41" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-38" target="Bpqc18DR_6Pw1rMxWVhk-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-38" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;__init__(state_dim, obs_dim, action_dim, n_agent, n_block, n_embd, n_head, encode_state=False, device=torch.device(&quot;cpu&quot;), action_type=&#39;Discrete&#39;, dec_actor=False, share_actor=False)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="-522.5" y="1910" width="535" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-40" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;n_agent&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; n_agent&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_dim&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;dict&lt;/span&gt;(&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;torch&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; action_type&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;device&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; device&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state unused&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state_dim&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;37&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;encoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Encoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_block&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_head&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; encode_state&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;decoder&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #a85ff1;&quot;&gt;Decoder&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_block&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_embd&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_head&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; n_agent&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dec_actor&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;dec_actor&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;share_actor&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;share_actor&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;to&lt;/span&gt;(&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="-610" y="2050" width="710" height="230" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-42" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;zero_std()&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="257.5" y="1910" width="95" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-43" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;!=&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(0, 168, 132);&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;decoder&lt;/span&gt;.&lt;span style=&quot;color: rgb(17, 183, 212);&quot;&gt;zero_std&lt;/span&gt;(&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: rgb(212, 119, 12);&quot;&gt;device&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="137.5" y="1990" width="300" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-45" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.557;entryY=-0.06;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-42" target="Bpqc18DR_6Pw1rMxWVhk-43">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-47" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;forward(self, state, obs, action, available_actions=None)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="582.5" y="1910" width="225" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-48" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state: (batch, n_agent, state_dim)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# obs: (batch, n_agent, obs_dim)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# action: (batch, n_agent, 1)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# available_actions: (batch, n_agent, act_dim)&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state unused&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;shape&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;state&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;[:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;37&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;action&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;available_actions&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;shape&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;v_loc&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;encoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&#39;Discrete&#39;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;long&lt;/span&gt;()&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;discrete_parallel_act&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;decoder&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action_log&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;entropy&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;continuous_parallel_act&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;decoder&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;action&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;action_log&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;v_loc&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;entropy&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="457.5" y="1990" width="850" height="470" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.279;entryY=-0.003;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-47" target="Bpqc18DR_6Pw1rMxWVhk-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-52" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;get_actions(self, state, obs, available_actions=None, deterministic=False)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1447.5" y="1910" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-53" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state unused&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;shape&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;[:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;37&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; available_actions &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;is&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;not&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #e35535;&quot;&gt;None&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;available_actions&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;shape&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;)[&lt;span style=&quot;color: #d4770c;&quot;&gt;0&lt;/span&gt;]&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;v_loc&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;encoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_type&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;==&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #00a884;&quot;&gt;&quot;Discrete&quot;&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;discrete_autoregreesive_act&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;decoder&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                    &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;available_actions&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; deterministic&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;else&lt;/span&gt;:&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt;    &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;output_action_log&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;continuous_autoregreesive_act&lt;/span&gt;(&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;decoder&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;batch_size&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;n_agent&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;action_dim&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;,&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;                                                                        deterministic&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;output_action&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;output_action_log&lt;/span&gt;,&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;v_loc&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="1337.5" y="1990" width="890" height="430" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-52">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1607.5" y="1990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-57" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;&lt;b&gt;get_values(self, state, obs, available_actions=None)&lt;/b&gt;&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="2325" y="1910" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-59" value="&lt;div style=&quot;color: rgb(190, 198, 208); font-family: &amp;quot;Droid Sans Mono&amp;quot;, &amp;quot;monospace&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(71, 82, 98); font-style: italic;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;# state unused&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;shape&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;state&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;zeros&lt;/span&gt;((&lt;span style=&quot;color: #c7910c;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;ori_shape&lt;/span&gt;[:&lt;span style=&quot;color: #c7910c;&quot;&gt;-&lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;1&lt;/span&gt;],&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;37&lt;/span&gt;),&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d46ec0;&quot;&gt;dtype&lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;np&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;float32&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #11b7d4;&quot;&gt;check&lt;/span&gt;(&lt;span style=&quot;color: #11b7d4;&quot;&gt;obs&lt;/span&gt;).&lt;span style=&quot;color: #11b7d4;&quot;&gt;to&lt;/span&gt;(**&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #d4770c;&quot;&gt;tpdv&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;v_tot&lt;/span&gt;,&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs_rep&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c7910c;&quot;&gt;=&lt;/span&gt;&lt;span style=&quot;color: #a0acbb;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #d4770c;&quot;&gt;self&lt;/span&gt;.&lt;span style=&quot;color: #11b7d4;&quot;&gt;encoder&lt;/span&gt;(&lt;span style=&quot;color: #c62f52;&quot;&gt;state&lt;/span&gt;,&lt;span style=&quot;color: #11b7d4;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #c62f52;&quot;&gt;obs&lt;/span&gt;)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;font style=&quot;font-size: 13px;&quot;&gt;&lt;span style=&quot;color: rgb(199, 145, 12);&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: rgb(160, 172, 187);&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: rgb(198, 47, 82);&quot;&gt;v_tot&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="2260" y="1990" width="450" height="170" as="geometry" />
        </mxCell>
        <mxCell id="Bpqc18DR_6Pw1rMxWVhk-60" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="Bpqc18DR_6Pw1rMxWVhk-57">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="2425" y="1990" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
